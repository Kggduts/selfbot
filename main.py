import base64
exec(base64.b64decode(b'aW1wb3J0IHN5cw0KaW1wb3J0IGpzb24NCmltcG9ydCB0aW1lDQppbXBvcnQgZGF0ZXRpbWUNCmltcG9ydCByZXF1ZXN0cw0KaW1wb3J0IHRocmVhZGluZw0KDQpmcm9tIG93by5jbGllbnQgaW1wb3J0IE93T1NlbGZib3QNCg0KY2xhc3MgS2V5TWFuYWdlcjoNCglkZWYgX19pbml0X18oc2VsZiwgY2xpZW50KToNCgkJc2VsZi5jbGllbnQgPSBjbGllbnQNCgkJc2VsZi5wYXltZW50X2tleSA9IHNlbGYuZ2V0X3BheW1lbnQoKQ0KCQlzZWxmLnRyaWFsX2tleSA9IHNlbGYuZ2V0X3RyaWFsKCkNCg0KCWRlZiBnZXRfcGF5bWVudChzZWxmKToNCgkJZ2l0aHViID0gcmVxdWVzdHMuZ2V0KHNlbGYuY2xpZW50LmRhdGFbJ2tleSddWydwYXltZW50J10pLnRleHQNCgkJcmV0dXJuIGxpc3QoZmlsdGVyKGJvb2wsIGdpdGh1Yi5zcGxpdCgiXG4iKSkpDQoNCglkZWYgZ2V0X3RyaWFsKHNlbGYpOg0KCQlnaXRodWIgPSByZXF1ZXN0cy5nZXQoc2VsZi5jbGllbnQuZGF0YVsna2V5J11bJ3RyaWFsJ10pLnRleHQNCgkJcmV0dXJuIGxpc3QoZmlsdGVyKGJvb2wsIGdpdGh1Yi5zcGxpdCgiXG4iKSkpDQoNCglkZWYgZ2V0X2RhdGUoc2VsZik6DQoJCWRhdGUgPSBkYXRldGltZS5kYXRldGltZS5ub3coZGF0ZXRpbWUuVVRDKQ0KCQlyZXR1cm4gZGF0ZS55ZWFyICogZGF0ZS5tb250aCAqIGRhdGUuZGF5DQoNCglkZWYgZXhwaXJlX3RyaWFsKHNlbGYpOg0KCQlleHBpcmUgPSBkYXRldGltZS5kYXRldGltZS5ub3coZGF0ZXRpbWUuVVRDKS5yZXBsYWNlKGhvdXIgPSAwLCBtaW51dGUgPSAwLCBzZWNvbmQgPSAwLCBtaWNyb3NlY29uZCA9IDApDQoJCWlmIGRhdGV0aW1lLmRhdGV0aW1lLm5vdyhkYXRldGltZS5VVEMpIDwgZXhwaXJlOg0KCQkJZXhwaXJlID0gZXhwaXJlIC0gZGF0ZXRpbWUudGltZWRlbHRhKGRheXMgPSAxKQ0KCQlleHBpcmUgPSAoZXhwaXJlIC0gZGF0ZXRpbWUuZGF0ZXRpbWUubm93KGRhdGV0aW1lLlVUQykpLnNlY29uZHMNCgkJcHJpbnQoZiJbK10gSXQgd2lsbCBleHBpcmUgaW4ge2RhdGV0aW1lLnRpbWVkZWx0YShzZWNvbmRzID0gZXhwaXJlKX0iKQ0KCQlyZXR1cm4oZXhwaXJlKQ0KDQoJZGVmIGVudGVyX3RyaWFsKHNlbGYpOg0KCQlrZXkgPSBzZWxmLmdldF9kYXRlKCkNCgkJcHJpbnQoZiJbK10gR2V0IHRyaWFsIGtleTogeyIiLmpvaW4oZiJcblsrXSB7eH0iIGZvciB4IGluIHNlbGYudHJpYWxfa2V5KX1cbiIpDQoJCWFuc3dlciA9IGlucHV0KCJbP10gRW50ZXIgdHJpYWwga2V5OiAiKQ0KCQlpZiBhbnN3ZXIgPT0gc3RyKGtleSk6DQoJCQl3aXRoIG9wZW4oc2VsZi5jbGllbnQuZmlsZSkgYXMgZmlsZToNCgkJCQljb25maWcgPSBqc29uLmxvYWQoZmlsZSkNCgkJCWNvbmZpZ1sndHJpYWwnXSA9IGFuc3dlcg0KCQkJd2l0aCBvcGVuKCJjb25maWdzL2tleS5qc29uIiwgInciKSBhcyBmaWxlOg0KCQkJCWpzb24uZHVtcChjb25maWcsIGZpbGUsIGluZGVudCA9IDQpDQoJCQlwcmludChmIlsrXSBUaGUgdHJpYWwga2V5IGlzIENPUlJFQ1QgKHthbnN3ZXJ9KSIpDQoJCQlyZXR1cm4gVHJ1ZQ0KCQllbHNlOg0KCQkJcHJpbnQoZiJbLV0gVGhlIHRyaWFsIGtleSBpcyBJTkNPUlJFQ1QgKHthbnN3ZXJ9KSIpDQoNCmNsYXNzIFBoYW5kYXRTZWxmYm90Og0KCWRlZiBfX2luaXRfXyhzZWxmKToNCgkJc2VsZi5maWxlID0gImNvbmZpZ3Mva2V5Lmpzb24iDQoJCXNlbGYuZGF0YSA9IHNlbGYuZ2V0X2RhdGEoKQ0KCQlzZWxmLmtleV9tYW5hZ2VyID0gS2V5TWFuYWdlcihzZWxmKQ0KDQoJZGVmIGdldF9kYXRhKHNlbGYpOg0KCQlyZXR1cm4gcmVxdWVzdHMuZ2V0KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcmVhbHBoYW5kYXQvcmVhbHBoYW5kYXQvbWFpbi9waGFuZGF0LXNlbGZib3QvZGF0YS5qc29uIikuanNvbigpDQoNCglkZWYgb3dvX3NlbGZib3Qoc2VsZik6DQoJCXRocmVhZHMgPSBbXQ0KCQlPd09DbGllbnRzID0gW10NCgkJd2l0aCBvcGVuKCJjb25maWdzL293b19zZWxmYm90Lmpzb24iKSBhcyBmaWxlOg0KCQkJb3dvX2NvbmZpZyA9IGpzb24ubG9hZChmaWxlKQ0KCQlmb3IgdG9rZW4gaW4gb3dvX2NvbmZpZzoNCgkJCU93T0NsaWVudCA9IE93T1NlbGZib3QoT3dPQ2xpZW50cywgdG9rZW4pDQoJCQlPd09DbGllbnRzLmFwcGVuZChPd09DbGllbnQpDQoJCQl0aHJlYWQgPSB0aHJlYWRpbmcuVGhyZWFkKHRhcmdldCA9IE93T0NsaWVudC5ydW4sIGRhZW1vbiA9IFRydWUsIGFyZ3MgPSAodG9rZW4sKSkNCgkJCXRocmVhZHMuYXBwZW5kKHRocmVhZCkNCgkJCXRocmVhZC5zdGFydCgpDQoJCXJldHVybiB0aHJlYWRzDQoNCglkZWYgc3RhcnQoc2VsZiwgZXhwaXJlKToNCgkJdGhyZWFkcyA9IFtdDQoJCXdpdGggb3BlbigiY29uZmlncy9tb2RlLmpzb24iKSBhcyBmaWxlOg0KCQkJbW9kZSA9IGpzb24ubG9hZChmaWxlKQ0KCQlpZiBtb2RlWydvd29fc2VsZmJvdCddOg0KCQkJdGhyZWFkcy5leHRlbmQoc2VsZi5vd29fc2VsZmJvdCgpKQ0KDQoJCWlmIGV4cGlyZToNCgkJCXRpbWUuc2xlZXAoZXhwaXJlKQ0KCQkJc3lzLmV4aXQoIlstXSBUaGUgdHJpYWwga2V5IGV4cGlyZWQiKQ0KCQllbHNlOg0KCQkJZm9yIHRocmVhZCBpbiB0aHJlYWRzOg0KCQkJCXRocmVhZC5qb2luKCkNCg0KCWRlZiBjaGVja19rZXkoc2VsZik6DQoJCXByaW50KHJlcXVlc3RzLmdldChzZWxmLmRhdGFbJ2ludHJvJ10pLnRleHQpDQoNCgkJZXhwaXJlID0gMA0KCQl3aXRoIG9wZW4oImNvbmZpZ3Mva2V5Lmpzb24iKSBhcyBmaWxlOg0KCQkJa2V5ID0ganNvbi5sb2FkKGZpbGUpDQoJCWlmIGtleVsncGF5bWVudCddIGluIHNlbGYua2V5X21hbmFnZXIucGF5bWVudF9rZXk6DQoJCQlwcmludChmIlsrXSBUaGUgcGF5bWVudCBrZXkgaXMgQ09SUkVDVCAoe2tleVsncGF5bWVudCddfSkiKQ0KCQllbHNlOg0KCQkJcHJpbnQoZiJbLV0gVGhlIHBheW1lbnQga2V5IGlzIElOQ09SUkVDVCAoe2tleVsncGF5bWVudCddfSkiKQ0KCQkJaWYga2V5Wyd0cmlhbCddID09IHN0cihzZWxmLmtleV9tYW5hZ2VyLmdldF9kYXRlKCkpOg0KCQkJCXByaW50KGYiWytdIFRoZSB0cmlhbCBrZXkgaXMgQ09SUkVDVCAoe2tleVsndHJpYWwnXX0pIikNCgkJCWVsc2U6DQoJCQkJaWYgbm90IHNlbGYua2V5X21hbmFnZXIuZW50ZXJfdHJpYWwoKToNCgkJCQkJcmV0dXJuDQoJCQlleHBpcmUgPSBzZWxmLmtleV9tYW5hZ2VyLmV4cGlyZV90cmlhbCgpDQoJCXNlbGYuc3RhcnQoZXhwaXJlKQ0KDQoNCmlmIF9fbmFtZV9fID09ICJfX21haW5fXyI6DQoJcGhhbmRhdF9zZWxmYm90ID0gUGhhbmRhdFNlbGZib3QoKQ0KCXBoYW5kYXRfc2VsZmJvdC5jaGVja19rZXkoKQ==').decode("utf-8"))